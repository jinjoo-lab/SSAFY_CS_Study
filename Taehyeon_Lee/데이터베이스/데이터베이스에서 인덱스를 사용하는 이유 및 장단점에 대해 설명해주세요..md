# 데이터베이스에서 인덱스를 사용하는 이유 및 장단점에 대해 설명해주세요.

<aside>
💡 데이터베이스에서 인덱스는 데이터베이스 테이블의 검색 성능을 향상시키 위해서입니다. 인덱스를 사용하지 않는 경우, 특정 값을 검색하기 위해 데이터베이스 전체를 순차 탐색해야하지만, 인덱스를 사용한다면, O(N)보다 작은 시간내에 일치하는 데이터를 검색할 수 있습니다. 다만, 테이블의 전체 크기 너무 작은 경우나, update나 delete가 빈번한 칼럼을 인덱스로 설정할 경우 오히려 성능을 저하시킬수 있기에, 상황에 맞게 적절하게 사용하는 것이 중요합니다.

</aside>

## 인덱스란?

- 추가적인 쓰기 작업과 저장공간을 활용하여 db 테이블의 검색속도를 향상시키기 위한 자료구조
- 인덱스를 사용하지 않는 다면 특정 값과 일치하는 데이터를 찾기 위해 테이블 전체를 순차 탐색해야하는 문제가 발생한다

## 인덱스의 장점과 단점

장점

- where절의 효율성
    - 인덱스를 사용하지 않는 경우에 발생하는 전체 탐색(full scan)을 피할 수 있다
    - 인덱스를 사용하면 데이터가 정렬되어 저장되기 때문에, 조건 검색시 빠르게 검색 가능
- orderBy의 효율성
    - 인덱스를 기준으로 정렬되어 저장되기 때문에, sort과정을 생략할 수 있다
    - ORDER BY 작업은 1차적으로 메모리에서 정렬을 하고, 메모리보다 큰 작업은 디스크 I/O를 통해 정렬을 하는 무거운 작업이다
- Min, Max을 빠르게 탐색할 수 있다, 양 끝 값 이용
- 전반적인 시스템 부하 줄이는 효과

단점

- 인덱스를 관리하기 위해 DB에 10%에 해당하는 저장공간 필요
- 인덱스를 관리하기위해 추가작업 필요
- 인덱스를 잘못 사용하는 경우, 성능이 저하되는 역효과 가능성 존재

### 성능이 저하되는 이유

- create, delete, update가 빈번한 속성에 인덱스를 거는 경우,
- 인덱스의 크기가 비대해져 성능이 저하됨
    - update, delete연산 때문
    - update, delete는 기존의 인덱스를 삭제하지 않고, “사용하지 않음”처리
    - 어떤 테이블에 update와 delete가 매우 빈번하게 발생한 경우, 실제 데이터는 10만건일 때, 그보다 더 많은 인덱스가 저장되어 있을 수 있다
    - 이는 SQL문 처리시에 성능 저하를 야기한다

## 인덱스를 사용하면 좋은 경우

- 규모가 작지 않은 테이블
- 고유값을 많이 가지는 column
- insert, update, delete가 자주발생하지 않는 column
- join이나 where또는 orderby에 자주 사용되는 column
- 데이터의 중복도가 낮은 column

## 인덱스의 자료구조

### 해시테이블

- key-value로 데이터 저장하는 자료구조
- 빠른 데이터 검색이 필요할 때 유용
- 시간 복잡도는 `O(1)`
- 등호 연산에만 특화되었다는 단점이 있다
- 부등호 연산이 자주 사용되는 db에서는 해시테이블은 적합하지 않다

### B+Tree

- 자식노드가 2개 이상인 B-Tree를 개선시킨 자료구조
- 인덱스 노드에는 인덱스(key)값만 가지고 있다
- 리프 노드에만 (인덱스+데이터)를 저장
    - 리프노드들은 linkedList로 연결되어있다
- 인덱스노드와 데이터 노드의 크기는 달라도 된다

### DB에 B+Tree가 해시테이블보다 적합한 이유

- db의 인덱스 칼럼은 부등호를 이용한 순차 검색이 빈번하다
- BTree의 리프노드들을 LinkedList로 연결하여 순차검색을 용이하게 최적화하였다
- 시간복잡도는 O(log2N)이지만 해시테이블보다 인덱싱에 더 적합하다

[https://mangkyu.tistory.com/96](https://mangkyu.tistory.com/96)

[https://velog.io/@guswns3371/데이터베이스-데이터베이스에서-인덱스를-사용하는-이유](https://velog.io/@guswns3371/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%EC%97%90%EC%84%9C-%EC%9D%B8%EB%8D%B1%EC%8A%A4%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0)