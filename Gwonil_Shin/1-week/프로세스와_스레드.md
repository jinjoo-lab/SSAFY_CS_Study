# 프로세스와 스레드,그리고 차이점


## 내용

- 프로그램

  파일이 저장장치에 저장되어 있지만 메모리에는 올라가있지 않은 정적인 상태 (실행전 상태인 코드 덩어리)

- 프로세스

  프로그램이 실행되어서 메모리에 올라간 동적인 상태

  운영체제로부터 자원을 할당받은 작업의 단위

- 스레드

  프로세스가 할당받은 자원을 이용하는 실행흐름의 단위

  (CPU 입장에서의 최소 작업 단위)


- 스레드가 생겨난 과정

  프로그램이 복잡해지면서 하나의 프로세스로 프로그램을 돌리기 어려워짐

  → 여러 프로세스로 돌리면 될거 같은데?

  → 프로세스는 메모리를 많이 사용해서 여러개를 사용하는 건 메모리 낭비가 된다.

- 프로세스의 자원

  프로세스가 메모리로 올라가게 되면 OS로부터 자원을 할당 받는다.

    - 자원

      독립된 메모리 영역으로 Code/Data/Heap/Stack의 형식으로 할당된다.

      해당 자원은 다른 프로세스가 접근할 수 없다.

        - 형식
            - Code

              코드들이 기계어로 저장되어 있는 영역

            - Data

              코드가 실행되면서 사용되는 전역변수 및 각종 데이터가 모여있는 영역

                - 데이터 종류
                    - .data

                      초기화 된 전역 변수,static 변수등 프로그램이 사용하는 데이터

                    - .BSS

                      초기값이 없는 전역변수,static 변수 데이터

                    - .rodata

                      const와 같은 상수 키워드로 선언된 변수나 문자열 상수

            - Stack

              지역변수와 같은 임시적인 자료를 저장하는 공간, 함수 호출시 할당이 되고 호출이 완료되면 소멸한다. stack이 초과할시 StackOverFlow에러가 발생한다.

            - Heap

              생성자,인스턴스와 같은 동적할당 데이터들이 저장되는 공간.

- 스레드의 자원

  프로세스와 달리 스레드는 프로세스 내부에서 Code,Data,Heap을 공유자원으로 가지고 스레드 별로 stack을 가지게 된다.

- 데이터 공유로 인한 특징

  프로세스는 하나의 프로세스가 오류 발생으로 강제종료될시 공유 파일 손상과 같은 특별한 경우가 아니라면 다른 프로세스에 영향을 안준다.

  하지만 스레드가 강제종료 되게 되면 다른 스레드들도 강제 종료가 된다.


- 프로세스간 자원 공유 방식
    1. IPC(Inter-Process Communication)
        - 종류
            - Shared Memory
            - Pipe
            - Socket
            - Message Queue
            - Memory Map
            - RPC
    2. LPC(Local inter-Process Communication)
    - 문제점

      자원 부담이 크다

      ⇒ 현대의 컴퓨터 OS는 멀티스레딩을 기본으로 한다. (멀티 프로세싱도 지원한다.)


- 멀티스레딩

  병렬성(Parallelism)과 동시성(Concurrency)를 기반으로 하는 수행으로 여러 작업들을 잘개 쪼개서 조금씩 수행하는 방식

    - 장점
        - 프로세스에 비해 Context-Switching시 공유 메모리만큼의 메모리 자원을 절약할수 있다.
        - Stack을 제외한 모든 메모리가 공유되기에 통신 부담이 적어 응답 시간이 빠르다.
    - 단점
        - 한 스레드가 프로세스의 자원을 망쳐버리면 프로세스 자체가 종료될 수 있다.
        - 동기화 문제가 발생한다.
    - 스레드 풀

      스레드 컨텍스트 스위칭의 오버헤드를 방지하기 위한 기법으로 사전에 일정 수량의 스레드를 만들어놓고 해당 스레드로 작업을 처리하는 것을 의미한다.